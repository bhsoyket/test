<!DOCTYPE html>
<html lang="en">
<head>
    <title>Dashboard</title>
    <link rel="icon" href="/images/CompleteGreet/FavIcon.png">

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/fontawesome.css">
    <link rel="stylesheet" href="/css/bootstrap.css">
    <link rel="stylesheet" href="/css/mdb.css">
    <link rel="stylesheet" href="/css/Input-Style.css">
    <link rel="stylesheet" type="text/css" href="/css/Sidebar.css">
    <link rel="stylesheet" type="text/css" href="/css/Dashboard.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">


</head>
<body class="hold-transition sidebar-mini">
<div class="newbubblewidget  ">
    <a class=" d-flex text-white justify-content-center align-items-center w-100 h-100" href="/users/bubble">  <i class="fa-solid fa-video fa-xl"></i></a>
</div>

<%  include UserNavBar.ejs%>


<div class="page-container">
    <div class="container-row d-flex flex-row ">
        <%  include UsersSideBar.ejs%>

        <div class="page-content-column mt-5 w-100 mr-lg-0">
            <div class="Dashboard-Container">
                <div class="Title">
                    Good morning,
                    <span class="title-name"> <%=user.Name%></span>
                </div>
                <div class="real-time-overview-text mt-2">Real time overview</div>
                        <div class="row mr-0">
                            <div class="col-xl-9">
                                <div class="row">

                            <div class="col-md-3 col-6 mt-3">
                                <div class="overview-card">
                                    <div class="overview-no"><%=ChatNumber%></div>
                                    <div class="overview-left-text">New: <%=NewChatnumber%></div>
                                    <div class="overview-right-text">Old: <%=ChatNumber-NewChatnumber%></div>
                                    <div class="red-part overview-bottom-part">Chats</div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mt-3">
                                <div class="overview-card">
                                    <div class="overview-no"><%=AllTimeVisitorNumber%></div>
                                    <div class="overview-left-text">New: <%=NewVisitorsNumber%></div>
                                    <div class="overview-right-text">Old: <%=OldVisitorsNumber%></div>
                                    <div class="pink-part overview-bottom-part">All Visitors</div>
                                </div>
                            </div>
                                    <%if (user.userGroup!=1200){%>
                                    <div class="col-md-6 col-12 mt-3">
                                        <div class="overview-card">
                                            <div class="progress-parent h-100 d-flex align-items-center ">
                                                <div class="progress visitor-progress-bar w-100 d-flex justify-content-between align-items-center  ">

                                                    <div class="progress-bar h-75" role="progressbar" style="min-width:40px;width: <%=100*MonthAgoVisitorsNum/AllowVisitorpermonth%>%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"><%=parseFloat(100*MonthAgoVisitorsNum/AllowVisitorpermonth).toFixed( 2 )%>%</div>
                                                </div>
                                            </div>
                                            <div class="overview-left-text">
                                                <% var months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];var date = new Date();dateString = months[date.getMonth()] + ' ' + date.getFullYear();%>
                                                <%=dateString%>
                                            </div>
                                            <div class="overview-right-text"><%=MonthAgoVisitorsNum%>/ <%=AllowVisitorpermonth%></div>
                                            <div class="overview-left-text w-100 text-center" style="top: 10px ;font-size: 17px;text-decoration: underline"><a  class=" text-dark" href="/pricing">Increase capacity</a></div>


                                            <div class="orange-part overview-bottom-part">Capacity of visitors </div>

                                        </div>
                                    </div>
<%}else {%>
                                    <div class="col-md-6 col-12 mt-3">
                                        <div class="overview-card">
                                            <div class="overview-no">Admin</div>
                                            <div class="overview-left-text">Admin</div>
                                            <div class="overview-right-text">Admin</div>
                                            <div class="orange-part overview-bottom-part">Capacity of visitors</div>
                                        </div>
                                    </div>

                                    <%}%>
                                    <div class="col-md-6 col-xl-6  mt-4 mt-xl-3 ">
                                        <div class="user-preferences-container p-4 mb-3 w-100 d-flex flex-column">
                                            <div class="d-flex flex-row justify-content-between ">
                                                <span class="mr-2">Live on chats</span>
                                                <div class="center">
                                                    <input <%if(user.LiveOnBubble){ %>checked<%}%> type="checkbox" id="LiveOnChat" >
                                                </div>
                                            </div>


                                        </div>
                                    </div>
                                    <div class="col-md-6 col-xl-6  mt-4 mt-xl-3 ">
                                        <div class="user-preferences-container justify-content-between p-4 mb-3 w-100 d-flex flex-row">
                                            <span class="mr-2">Push Notification</span>
                                            <div class="center">
                                                <input <%if(user.PushNotification){ %>checked<%}%> type="checkbox" id="PushNotification" >
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-6 col-xl-6  mt-3 mt-xl-3 ">
                                        <div class="user-preferences-container justify-content-between p-4 mb-3 w-100 d-flex flex-column">
                                            <div class="Note-Header">
                                                Notes:
                                            </div>
                                            <div class="d-flex flex-column mt-3">
                                                <label class="Input-Style auto-input-focus w-100">
                                                    <textarea style="resize: none; height: 200px" id="Notes" class="w-100" placeholder="Type here... "></textarea>
                                                    <span>Notes</span>
                                                </label>
                                                <button id="Notes-Btn" style="font: normal normal bold 20px/24px Montserrat;" class="Button mx-auto ">
                                                    Add note
                                                </button>
                                            </div>
                                            <div class="Notes-Container">

                                            </div>

                                        </div>
                                    </div>
                                    <div class="col-md-6 col-xl-6  mt-3 mt-xl-3 ">
                                        <div class="user-preferences-container justify-content-between p-4 mb-3 w-100 d-flex flex-column">
                                            <div class="Bug-Header">
                                                Reports:
                                            </div>
                                            <div class="d-flex flex-column mt-3">
                                                <label class="Input-Style auto-input-focus w-100">
                                                    <textarea style="resize: none; height: 200px" id="Bugs" class="w-100" placeholder="Type here... "></textarea>
                                                    <span>Find a bug?</span>
                                                </label>
                                                <button id="Bugs-Btn" style="font: normal normal bold 20px/24px Montserrat;" class="Button mx-auto ">
                                                    Submit
                                                </button>
                                            </div>
                                            <div class="Bugs-Container">

                                            </div>

                                        </div>
                                    </div>
                                </div>



                            </div>
                            <div class="col-md-12 col-xl-3  pl-xl-0">
                                <div class="live-chats-widget mt-xl-3 my-5 align-items-center d-flex flex-column justify-content-center">
                                    <div class="live-chats-widget-header mb-3">
                                        Live chats
                                    </div>
                                    <%if(Chats!=''){ Chats.forEach(function (chat){%>
                                    <div class="live-chats-widget-chat mb-3 p-2 w-100">
                                        <div class="name d-flex flex-row align-items-center justify-content-start  w-100">
                                            <img class=" img mr-2" src="/images/CompleteGreet/Avatar.jpg" alt="Avatar">
                                            <div class="live-chats-widget-name">
                                                <%=chat.ClientName%>
                                            </div>
                                        </div>
                                        <div class="live-chats-widget-message mt-3">
                                            <% var msg=Messages.find((x)=> x.ChatId == chat.id&&x.BubbleID==chat.BubbleID);if (msg!=undefined){%>
                                            <%=Messages.find((x)=> x.ChatId == chat.id&&x.BubbleID==chat.BubbleID).content%>
                                            <%}%>
                                        </div>
                                    </div>
                                    <%})}else {%>
                                        <div>There is no chats to view</div>
                                    <%}%>
                                    <div class="live-chats-widget-button mt-2">
                                        <a href="/users/livechat">view all</a>
                                    </div>
                                </div>
                            </div>



                        </div>

            </div>

        </div>
    </div>
</div>
<% include toasts.ejs%>


<script>
     var Chats=<%-JSON.stringify(Chats)%>
     var UserID='<%=user.id%>'
         var UserPushNotification='<%=user.PushNotification%>'
    var NotificationSound="<%=System[0].NotificationSound%>"

</script>
<script type="text/javascript" src="/js/jquery-3.5.1.min.js"></script>
<script type="application/javascript" src="/js/popper.min.js"></script>
<script type="application/javascript" src="/js/bootstrap.min.js"></script>
<script type="application/javascript" src="/js/mdb.min.js"></script>
<script type="application/javascript" src="/js/fontawesome.js"></script>
<script type="application/javascript" src="/js/Sidebar.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script type="application/javascript" src="/js/Dashboard.js"></script>


</body>
</html>


